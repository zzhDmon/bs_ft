webpackJsonp([9],{1029:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-date"}),e._v("模板设置")]),e._v(" "),e.paramsId<0?a("el-breadcrumb-item",[1==e.paramsType?a("span",[e._v("房源模板")]):e._e(),e._v(" "),3==e.paramsType?a("span",[e._v("问候模板")]):e._e(),e._v(" "),2==e.paramsType?a("span",[e._v("节日模板")]):e._e(),e._v("新增\n                ")]):a("el-breadcrumb-item",[1==e.paramsType?a("span",[e._v("房源模板")]):e._e(),e._v(" "),3==e.paramsType?a("span",[e._v("问候模板")]):e._e(),e._v(" "),2==e.paramsType?a("span",[e._v("节日模板")]):e._e(),e._v("修改\n                ")])],1)],1),e._v(" "),a("div",{staticClass:"form-box",staticStyle:{width:"100%"}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("div",[e._v("模板图片")]),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-upload",{attrs:{action:e.HOST+"/Upload/Save",data:{path:e.imagePath},"show-file-list":!1,"list-type":"picture-card","on-success":e.handleAvatarSuccess}},[e.form.ShowImages?a("img",{staticClass:"avatar",staticStyle:{width:"148px",height:"148px"},attrs:{src:e.form.ShowImages}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("div",[e._v("模板缩略图")]),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-upload",{attrs:{action:e.HOST+"/Upload/Save",data:{path:e.thumbImagePath},"show-file-list":!1,"list-type":"picture-card","on-success":e.thumHandleAvatarSuccess}},[e.form.ShowThumImages?a("img",{staticClass:"avatar",staticStyle:{width:"148px",height:"148px"},attrs:{src:e.form.ShowThumImages}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("div",[e._v("模板信息")]),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"标题："}},[a("el-input",{model:{value:e.form.Name,callback:function(t){e.$set(e.form,"Name",t)},expression:"form.Name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"状态："}},[a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"状态"},model:{value:e.form.PromoteStatus,callback:function(t){e.$set(e.form,"PromoteStatus",t)},expression:"form.PromoteStatus"}},e._l(e.types.PromoteStatus,function(e){return a("el-option",{key:e.Id,attrs:{label:e.Name,value:e.Id}})}))],1)],1),e._v(" "),1==e.paramsType?a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"类别："}},[a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"类别"},model:{value:e.form.HouseType,callback:function(t){e.$set(e.form,"HouseType",t)},expression:"form.HouseType"}},e._l(e.types.HouseTypes,function(e){return a("el-option",{key:e.Id,attrs:{label:e.Name,value:e.Id}})}))],1)],1):e._e(),e._v(" "),2==e.paramsType?a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"月份："}},[a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"月份"},model:{value:e.form.Month,callback:function(t){e.$set(e.form,"Month",t)},expression:"form.Month"}},e._l(e.months,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1)],1):e._e(),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{prop:"Score",label:"积分："}},[a("el-input",{model:{value:e.form.Score,callback:function(t){e.$set(e.form,"Score",t)},expression:"form.Score"}})],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{"before-close":e.closeDiaolg,visible:e.dialogVisible,size:"tiny"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.preImageUrl,alt:""}})]),e._v(" "),e._l(e.form.Config.DrawingPart,function(t,s){return 11!==s&&13!==s?[a("div",[e._v(e._s(t.Name))]),e._v(" "),a("el-row",[0!==s?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"X："}},[a("el-input",{attrs:{type:"number"},model:{value:t.X,callback:function(a){e.$set(t,"X",a)},expression:"item.X"}})],1)],1):e._e(),e._v(" "),0!==s?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"Y："}},[a("el-input",{attrs:{type:"number"},model:{value:t.Y,callback:function(a){e.$set(t,"Y",a)},expression:"item.Y"}})],1)],1):e._e(),e._v(" "),void 0!==t.Width?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"宽："}},[a("el-input",{attrs:{type:"number"},model:{value:t.Width,callback:function(a){e.$set(t,"Width",a)},expression:"item.Width"}})],1)],1):e._e(),e._v(" "),void 0!==t.Height?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"高："}},[a("el-input",{attrs:{type:"number"},model:{value:t.Height,callback:function(a){e.$set(t,"Height",a)},expression:"item.Height"}})],1)],1):e._e(),e._v(" "),1==s||7==s?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"绘制顺序："}},[a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"绘制顺序"},model:{value:t.Sort,callback:function(a){e.$set(t,"Sort",a)},expression:"item.Sort"}},e._l(e.form.Config.SortData,function(e){return a("el-option",{key:e.Id,attrs:{label:e.Name,value:e.Id}})}))],1)],1):e._e(),e._v(" "),void 0!==t.TextColor?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"字体颜色："}},[a("el-input",{model:{value:t.TextColor,callback:function(a){e.$set(t,"TextColor",a)},expression:"item.TextColor"}})],1)],1):e._e(),e._v(" "),void 0!==t.EmSize?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"文字大小："}},[a("el-input",{attrs:{type:"number"},model:{value:t.EmSize,callback:function(a){e.$set(t,"EmSize",a)},expression:"item.EmSize"}})],1)],1):e._e(),e._v(" "),void 0!==t.TextLength?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"最大字数："}},[a("el-input",{attrs:{type:"number"},model:{value:t.TextLength,callback:function(a){e.$set(t,"TextLength",a)},expression:"item.TextLength"}})],1)],1):e._e(),e._v(" "),void 0!==t.Family?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"字体："}},[a("el-input",{model:{value:t.Family,callback:function(a){e.$set(t,"Family",a)},expression:"item.Family"}})],1)],1):e._e(),e._v(" "),void 0!==t.IsDrawing?a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"是否绘制："}},[a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"是否绘制"},model:{value:t.IsDrawing,callback:function(a){e.$set(t,"IsDrawing",a)},expression:"item.IsDrawing"}},e._l(e.form.Config.IsDrawData,function(e,t){return a("el-option",{key:t,attrs:{label:e.Name,value:e.Id}})}))],1)],1):e._e()],1)]:e._e()}),e._v(" "),a("el-form-item",[a("p",[e._v("Tips：字体颜色默认白色（rgb(255,250,250)填 250|250|250），最大字数0不限制")])]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("form")}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.preSubmit("form")}}},[e._v("保存并预览")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],2)],1)])},staticRenderFns:[]}},535:function(e,t,a){var s=a(200)(a(603),a(1029),null,null);e.exports=s.exports},541:function(e,t,a){e.exports={default:a(544),__esModule:!0}},544:function(e,t,a){var s=a(66),r=s.JSON||(s.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},603:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(541),r=a.n(s);t.default={data:function(){return{paramsType:"",paramsId:"",form:{Config:{DrawingPart:[]}},imagePath:"",thumbImagePath:"",types:"",months:[1,2,3,4,5,6,7,8,9,10,11,12],dialogVisible:!1,preImageUrl:"http://imgs.wujiuyun.com//Images//template/poster//C158D7DBAD0B4095B63ABB8BECC09823.png",rules:{Score:[{required:!0,message:"请输入积分",trigger:"blur"}]}}},watch:{$route:function(){this.paramsId=this.$route.params.id,this.paramsType=this.$route.params.templatetype,this.myaxios()}},created:function(){var e=this;this.paramsId=this.$route.params.id,this.paramsType=this.$route.params.templatetype,this.myaxios(),setTimeout(function(){e.$nextTick(function(){})},100)},methods:{myaxios:function(){var e=this;if(this.paramsId<0)var t="";else var t=this.paramsId;this.$http.get(this.HOST+"/template/Get",{params:{TemplateType:this.paramsType,Id:t}}).then(function(t){t.data.Config=JSON.parse(t.data.Config),t.data.Config?(e.form=t.data,e.imagePath=e.form.Config.ImagePath,e.ThumbImagePath=e.form.Config.ImagePath+"/thumb/"):(t.data.Config={DrawingPart:[]},e.form=t.data,e.$http.get(e.HOST+"/template/GetConfig",{params:{TemplateType:e.paramsType}}).then(function(t){e.form.Config=t.data,e.imagePath=e.form.Config.ImagePath,e.ThumbImagePath=e.form.Config.ImagePath+"/thumb/"},function(t){e.$message.error("获取失败！")}))},function(e){}),this.$http.get(this.HOST+"/template/GetTPlEnums").then(function(t){e.types=t.data},function(e){})},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message({showClose:!0,message:"请将信息填写完整",type:"error"}),!1;var a=t.form;a.Config=r()(a.Config),a=r()(a),t.$http.post(t.HOST+"/template/Save",{TemplateType:t.paramsType,data:a}).then(function(e){0==e.data.status&&(t.$message.success("成功"),t.$router.back())},function(e){t.$message.error("失败")})})},preSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message({showClose:!0,message:"请将信息填写完整",type:"error"}),!1;var a=t.form;a.Config=r()(a.Config),a=r()(a),t.$http.post(t.HOST+"/template/Save",{TemplateType:t.paramsType,data:a}).then(function(e){if(0==e.data.status){t.$message.success("成功");var a=Date.now();"1"===t.paramsType?(t.preImageUrl="http://app.fang-tian.com/Images/Poster?aid=1&hId=1&tId="+e.data.id+"&time="+a,t.dialogVisible=!0):(t.preImageUrl="http://app.fang-tian.com/Images/Greet?aid=1&TemplateType="+t.paramsType+"&tId="+e.data.id+"&time="+a,t.dialogVisible=!0)}},function(e){t.$message.error("失败")})})},cancel:function(){this.$router.back()},closeDiaolg:function(){this.$router.back()},handleAvatarSuccess:function(e){0==e.error?(this.form.ShowImages=e.view,this.form.Images=e.url):this.$message.error(e.msg)},thumHandleAvatarSuccess:function(e){0==e.error?(this.form.ShowThumImages=e.view,this.form.ThumImages=e.url):this.$message.error(e.msg)}}}}});